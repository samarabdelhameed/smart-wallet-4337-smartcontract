---
// Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª
import "../styles/global.css";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebAuthn Wallet Tester</title>
  </head>
  <body class="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
    <h1 class="text-2xl font-bold mb-8">WebAuthn Wallet Tester ğŸ”’</h1>

    <div class="flex flex-col space-y-4">
      <button 
        id="registerButton" 
        class="px-6 py-3 bg-blue-500 text-white rounded hover:bg-blue-600"
      >
        Register (Create Passkey)
      </button>

      <button 
        id="loginButton" 
        class="px-6 py-3 bg-green-500 text-white rounded hover:bg-green-600"
      >
        Login (Sign In)
      </button>
    </div>

    <script type="module">
      // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… WebAuthn
      async function registerPasskey() {
        try {
          console.log("ğŸ”µ Starting Registration...");

          const publicKeyCredentialCreationOptions = {
            challenge: new Uint8Array(32), // Ù„Ø§Ø²Ù… ØªÙŠØ¬ÙŠ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙŠ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
            rp: {
              name: "WebAuthn Wallet Tester",
            },
            user: {
              id: new Uint8Array(16),
              name: "testuser@example.com",
              displayName: "Test User",
            },
            pubKeyCredParams: [{ alg: -7, type: "public-key" }],
            authenticatorSelection: {
              userVerification: "preferred",
            },
            timeout: 60000,
            attestation: "direct",
          };

          const credential = await navigator.credentials.create({
            publicKey: publicKeyCredentialCreationOptions,
          });

          console.log("âœ… Registered Credential:", credential);
          alert("âœ… Registration successful!");

        } catch (error) {
          console.error("âŒ Registration error:", error);
          alert("âŒ Registration failed!");
        }
      }

      // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù‡Ù†Ø¬Ù‡Ø²Ù‡Ø§ Ø¨Ø¹Ø¯ÙŠÙ†)
      async function loginPasskey() {
        alert("ğŸŸ¢ Ù„Ø³Ù‡ Ù‡Ù†Ø¬Ù‡Ø² ÙƒÙˆØ¯ Ø§Ù„Ù€ Login Ù„Ù…Ø§ Ù†Ø®Ù„Øµ Ø§Ù„Ù€ Register Ø§Ù„Ø£ÙˆÙ„!");
      }

      // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø§Ù„Ø¯ÙˆØ§Ù„
      document.getElementById("registerButton").addEventListener("click", registerPasskey);
      document.getElementById("loginButton").addEventListener("click", loginPasskey);
    </script>
  </body>
</html>
